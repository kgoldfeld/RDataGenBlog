---
comments: false
---



<div id="survival-data" class="section level2">
<h2>Survival data</h2>
<p>Time-to-event data, including both survival and censoring times, are created using functions <code>defSurv</code> and <code>genSurv</code>. The survival data definitions require a variable name as well as a specification of a scale value, which determines the mean survival time at a baseline level of covariates (i.e.Â all covariates set to 0). The Weibull distribution is used to generate these survival times. In addition, covariates (which have been defined previously) that influence survival time can be included in the <code>formula</code> field. Positive coeffecients are associated with longer survival times (and lower hazard rates). Finally, the <em>shape</em> of the distribution can be specified. A <code>shape</code> value of 1 reflects the <em>exponential</em> distribution.</p>
<pre class="r"><code># Baseline data definitions

def &lt;- defData(varname = &quot;x1&quot;, formula = 0.5, dist = &quot;binary&quot;)
def &lt;- defData(def, varname = &quot;x2&quot;, formula = 0.5, dist = &quot;binary&quot;)
def &lt;- defData(def, varname = &quot;grp&quot;, formula = 0.5, dist = &quot;binary&quot;)

# Survival data definitions

sdef &lt;- defSurv(varname = &quot;survTime&quot;, formula = &quot;1.5*x1&quot;, scale = &quot;grp*50 + (1-grp)*25&quot;, 
    shape = &quot;grp*1 + (1-grp)*1.5&quot;)
sdef &lt;- defSurv(sdef, varname = &quot;censorTime&quot;, scale = 80, shape = 1)

sdef</code></pre>
<pre><code>##       varname formula               scale               shape
## 1:   survTime  1.5*x1 grp*50 + (1-grp)*25 grp*1 + (1-grp)*1.5
## 2: censorTime       0                  80                   1</code></pre>
<p>The data are generated with calls to <code>genData</code> and <code>genSurv</code>:</p>
<pre class="r"><code># Baseline data definitions

dtSurv &lt;- genData(300, def)
dtSurv &lt;- genSurv(dtSurv, sdef)

head(dtSurv)</code></pre>
<pre><code>##    id x1 x2 grp survTime censorTime
## 1:  1  0  1   1       23         18
## 2:  2  0  0   1       30         18
## 3:  3  1  0   1      622         13
## 4:  4  1  0   1      448          8
## 5:  5  0  0   1       14        242
## 6:  6  0  0   0        5        117</code></pre>
<pre class="r"><code># A comparison of survival by group and x1

dtSurv[, round(mean(survTime), 1), keyby = .(grp, x1)]</code></pre>
<pre><code>##    grp x1    V1
## 1:   0  0   7.6
## 2:   0  1  20.5
## 3:   1  0  44.1
## 4:   1  1 195.0</code></pre>
<p>Observed survival times and censoring indicators can be generated by defining new fields:</p>
<pre class="r"><code>cdef &lt;- defDataAdd(varname = &quot;obsTime&quot;, formula = &quot;pmin(survTime, censorTime)&quot;, 
    dist = &quot;nonrandom&quot;)
cdef &lt;- defDataAdd(cdef, varname = &quot;status&quot;, formula = &quot;I(survTime &lt;= censorTime)&quot;, 
    dist = &quot;nonrandom&quot;)

dtSurv &lt;- addColumns(cdef, dtSurv)

head(dtSurv)</code></pre>
<pre><code>##    id x1 x2 grp survTime censorTime obsTime status
## 1:  1  0  1   1       23         18      18      0
## 2:  2  0  0   1       30         18      18      0
## 3:  3  1  0   1      622         13      13      0
## 4:  4  1  0   1      448          8       8      0
## 5:  5  0  0   1       14        242      14      1
## 6:  6  0  0   0        5        117       5      1</code></pre>
<pre class="r"><code># estimate proportion of censoring by x1 and group

dtSurv[, round(1 - mean(status), 2), keyby = .(grp, x1)]</code></pre>
<pre><code>##    grp x1   V1
## 1:   0  0 0.15
## 2:   0  1 0.10
## 3:   1  0 0.41
## 4:   1  1 0.61</code></pre>
<p>Here is a Kaplan-Meier plot of the data by the four groups:</p>
<p><img src="/page/survival_files/figure-html/unnamed-chunk-5-1.png" width="624" /></p>
</div>
