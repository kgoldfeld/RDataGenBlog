---
comments: false
---



<div id="longitudinal-data" class="section level2">
<h2>Longitudinal data</h2>
<p>To simulate longitudinal data, we start with a ‘cross-sectional’ data set and convert it to a time-dependent data set. The original cross-sectional data set may or may not include time-dependent data in the columns. In the next example, we measure outcome <code>Y</code> once before and twice after intervention <code>T</code> in a randomized trial:</p>
<pre class="r"><code>tdef &lt;- defData(varname = &quot;T&quot;, dist = &quot;binary&quot;, formula = 0.5)
tdef &lt;- defData(tdef, varname = &quot;Y0&quot;, dist = &quot;normal&quot;, formula = 10, variance = 1)
tdef &lt;- defData(tdef, varname = &quot;Y1&quot;, dist = &quot;normal&quot;, formula = &quot;Y0 + 5 + 5 * T&quot;, 
    variance = 1)
tdef &lt;- defData(tdef, varname = &quot;Y2&quot;, dist = &quot;normal&quot;, formula = &quot;Y0 + 10 + 5 * T&quot;, 
    variance = 1)

dtTrial &lt;- genData(500, tdef)
dtTrial</code></pre>
<pre><code>##       id T        Y0       Y1       Y2
##   1:   1 0 10.980688 15.18525 21.82423
##   2:   2 1 10.875771 21.48453 25.73824
##   3:   3 0  9.672272 13.92614 18.36053
##   4:   4 1 10.963518 20.96233 26.46764
##   5:   5 1  8.847974 19.89633 23.08740
##  ---                                  
## 496: 496 1 11.387677 21.40601 28.20389
## 497: 497 0 10.564220 14.26387 19.64208
## 498: 498 0  9.253943 15.12489 18.88724
## 499: 499 1 10.769542 24.49387 24.88346
## 500: 500 0  8.197200 15.16288 18.24214</code></pre>
<p>The data in longitudinal form is created with a call to <strong><code>addPeriods</code></strong>. If the cross-sectional data includes time dependent data, then the number of periods <code>nPeriods</code> must be the same as the number of time dependent columns. If a variable is not declared as one of the <code>timevars</code>, it will be repeated each time period. In this example, the treatment indicator <code>T</code> is not specified as a time dependent variable. (Note: if there are two time-dependent variables, it is best to create two data sets and merge them. This will be shown later in the vignette).</p>
<pre class="r"><code>dtTime &lt;- addPeriods(dtTrial, nPeriods = 3, idvars = &quot;id&quot;, timevars = c(&quot;Y0&quot;, 
    &quot;Y1&quot;, &quot;Y2&quot;), timevarName = &quot;Y&quot;)
dtTime</code></pre>
<p>This is what the longitudinal data look like:</p>
<p><img src="/page/longitudinal_files/figure-html/unnamed-chunk-4-1.png" width="576" /></p>
<div id="longitudinal-data-with-varying-observation-and-interval-times" class="section level3">
<h3>Longitudinal data with varying observation and interval times</h3>
<p>It is also possible to generate longitudinal data with varying numbers of measurement periods as well as varying time intervals between each measurement period. This is done by defining specific variables in the data set that define the number of observations per subject and the average interval time between each observation. <code>nCount</code> defines the number of measurements for an individual; <code>mInterval</code> specifies the average time between intervals for an subject; and <code>vInterval</code> specifies the variance of those interval times. If <code>vInterval</code> is set to 0 or is not defined, the interval for a subject is deterimined entirely by the mean interval. If <code>vInterval</code> is greater than 0, time intervals are generated using a gamma distribution with mean and dispersion specified.</p>
<p>In this simple example, the cross-sectional data generates individuals with a different number of measurement observations and different times between each observation. Data for two of these individuals is printed:</p>
<pre class="r"><code>def &lt;- defData(varname = &quot;xbase&quot;, dist = &quot;normal&quot;, formula = 20, variance = 3)
def &lt;- defData(def, varname = &quot;nCount&quot;, dist = &quot;noZeroPoisson&quot;, formula = 6)
def &lt;- defData(def, varname = &quot;mInterval&quot;, dist = &quot;gamma&quot;, formula = 30, variance = 0.01)
def &lt;- defData(def, varname = &quot;vInterval&quot;, dist = &quot;nonrandom&quot;, formula = 0.07)

dt &lt;- genData(200, def)
dt[id %in% c(8, 121)]  # View individuals 8 and 121</code></pre>
<pre><code>##     id    xbase nCount mInterval vInterval
## 1:   8 21.60666      4  32.97885      0.07
## 2: 121 19.28340     10  35.75381      0.07</code></pre>
<p>The resulting longitudinal data for these two subjects can be inspected after a call to <code>addPeriods</code>. Notice that no parameters need to be set since all information resides in the data set itself:</p>
<pre class="r"><code>dtPeriod &lt;- addPeriods(dt)
dtPeriod[id %in% c(8, 121)]  # View individuals 8 and 121 only</code></pre>
<pre><code>##      id period    xbase time timeID
##  1:   8      0 21.60666    0     38
##  2:   8      1 21.60666   36     39
##  3:   8      2 21.60666   65     40
##  4:   8      3 21.60666  104     41
##  5: 121      0 19.28340    0    723
##  6: 121      1 19.28340   31    724
##  7: 121      2 19.28340   84    725
##  8: 121      3 19.28340  129    726
##  9: 121      4 19.28340  154    727
## 10: 121      5 19.28340  188    728
## 11: 121      6 19.28340  222    729
## 12: 121      7 19.28340  245    730
## 13: 121      8 19.28340  279    731
## 14: 121      9 19.28340  315    732</code></pre>
<p>If a time sensitive measurement is added to the data set …</p>
<pre class="r"><code>def2 &lt;- defDataAdd(varname = &quot;Y&quot;, dist = &quot;normal&quot;, formula = &quot;15 + .1 * time&quot;, 
    variance = 5)
dtPeriod &lt;- addColumns(def2, dtPeriod)</code></pre>
<p>… a plot of a five randomly selected individuals looks like this:</p>
<p><img src="/page/longitudinal_files/figure-html/unnamed-chunk-8-1.png" width="576" /></p>
</div>
</div>
