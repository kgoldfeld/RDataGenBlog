---
title: A three-arm trial using two-step randomization
author: Package Build
date: '2023-12-19'
slug: []
categories: []
tags:
  - R
  - Cluster randomized trials
type: ''
subtitle: ''
image: ''
draft: TRUE
---

<link href="{{< blogdown/postref >}}index.en_files/tabwid/tabwid.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index.en_files/tabwid/tabwid.js"></script>


<p>I’ve been involved with designing a trial focused on comparing a clinical decision support (CDS) tool with an enhanced version of CDS (CDS+). The main goal is to directly compare patient-level outcomes for those who have been exposed to different versions of the CDS. However, we might also be interested in comparing the basic CDS with a control arm. This would suggest a three-arm trial.</p>
<p>A key question is the unit of randomization. If we can assume that CDS and CDS+ can be implemented at the patient level without any contamination (and in our case, we don’t think this is possible), the trial comparing these two could take advantage of patient-level randomization. However, because once you turn on CDS or CDS+ at the provider level, it would be impossible to have an uncontaminated control arm, suggesting a less efficient cluster randomized trial. One of my colleagues came up with a design that takes advantage of patient-level randomization while acknowledging the need to address potential contamination of the patients in the control arm. This would be accomplished by randomizing providers to either the control or CDS arms, and then randomizing patients within the CDS arm (stratified by provider) to either CDS or CDS+ intervention.</p>
<p>It should be fairly obvious that two-step approach with at least some patient-level randomization would be better (with respect to statistical power) than a more standard three-arm cluster randomized trial that could provide the same effect estimates (though my initial reaction was that it wasn’t so obvious). My goal here is to simulate data using each design and estimate power to confirm this.</p>
<div id="preliminaries" class="section level3">
<h3>Preliminaries</h3>
<p>Before we get started, here are the libraries that will be need for the simulations, model fitting, and outputting the results:</p>
<pre class="r"><code>library(simstudy)
library(ggplot2)
library(lmerTest)
library(data.table)
library(multcomp)
library(parallel)
library(flextable)</code></pre>
</div>
<div id="three-arm-cluster-randomized-trial" class="section level3">
<h3>Three-arm cluster randomized trial</h3>
<p>We’ll start with the three-arm cluster randomized trial, where providers would be randomized in a 1:1:1 ratio to either <span class="math inline">\(Control\)</span>, <span class="math inline">\(CDS\)</span>, or <span class="math inline">\(CDS+\)</span>. The data definitions for the cluster-level data includes a random effect <span class="math inline">\(b\)</span> and a three-level treatment indicator <span class="math inline">\(A\)</span>. The individual-level outcome is a continuous variable centered around 0 for patients in the control arm (offset by the provider-specific random effect). The effect of CDS (compared to Control) is 1.5, and the incremental effect of CDS+ (compared to CDS) is 0.75.</p>
<pre class="r"><code>defs &lt;- 
  defData(varname = &quot;b&quot;, formula = 0, variance = 1) |&gt;
  defData(varname = &quot;A&quot;, formula = &quot;1;1;1&quot;, dist = &quot;trtAssign&quot;) 

defy &lt;- 
  defDataAdd(varname = &quot;y&quot;, formula = &quot;0 + 1.50*(A==2) + 2.50*(A==3) + b&quot;, variance = 8)</code></pre>
<p>To generate a single data set, we generate the provider level data, add the patient-level records and generate the patient-level outcomes.</p>
<pre class="r"><code>set.seed(7161)

dc &lt;- genData(30, defs, id = &quot;provider&quot;)
dd &lt;- genCluster(dc, &quot;provider&quot;, 40, &quot;id&quot;)
dd &lt;- addColumns(defy, dd)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>A mixed effects model with a provider-level random effect gives the parameter estimates for the effect of CDS (versus control) and CDS+ (also versus control):</p>
<pre class="r"><code>lmerfit &lt;- lmer(y ~ factor(A) + (1|provider), data = dd)
as_flextable(lmerfit) |&gt; delete_part(part = &quot;footer&quot;)</code></pre>
<p><br></p>
<div class="tabwid"><style>.cl-17f95726{}.cl-17f53c04{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-17f6ab2a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-17f6ab34{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-17f6ab35{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-17f6b69c{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6a6{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6a7{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6a8{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6b0{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6b1{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6b2{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6b3{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6ba{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6bb{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6bc{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6c4{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6c5{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6c6{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6ce{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6cf{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6d0{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6d1{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6d8{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6d9{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6da{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6e2{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6e3{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6e4{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6e5{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6ec{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6ed{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6ee{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6f6{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6f7{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6f8{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b6f9{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b700{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b701{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b702{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b703{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b70a{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b70b{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b70c{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-17f6b714{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-17f95726'><thead><tr style="overflow-wrap:break-word;"><th class="cl-17f6b69c"><p class="cl-17f6ab2a"><span class="cl-17f53c04">group</span></p></th><th class="cl-17f6b6a6"><p class="cl-17f6ab2a"><span class="cl-17f53c04"></span></p></th><th class="cl-17f6b6a7"><p class="cl-17f6ab34"><span class="cl-17f53c04">Estimate</span></p></th><th class="cl-17f6b6a8"><p class="cl-17f6ab34"><span class="cl-17f53c04">Standard Error</span></p></th><th class="cl-17f6b6b0"><p class="cl-17f6ab34"><span class="cl-17f53c04">df</span></p></th><th class="cl-17f6b6b1"><p class="cl-17f6ab34"><span class="cl-17f53c04">statistic</span></p></th><th class="cl-17f6b6b2"><p class="cl-17f6ab34"><span class="cl-17f53c04">p-value</span></p></th><th class="cl-17f6b6b3"><p class="cl-17f6ab2a"><span class="cl-17f53c04"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-17f6b6ba"><p class="cl-17f6ab35"><span class="cl-17f53c04">Fixed effects</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-17f6b6d0"><p class="cl-17f6ab2a"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b6d1"><p class="cl-17f6ab2a"><span class="cl-17f53c04">(Intercept)</span></p></td><td class="cl-17f6b6d8"><p class="cl-17f6ab34"><span class="cl-17f53c04">-0.384</span></p></td><td class="cl-17f6b6d9"><p class="cl-17f6ab34"><span class="cl-17f53c04">0.389</span></p></td><td class="cl-17f6b6da"><p class="cl-17f6ab34"><span class="cl-17f53c04">27</span></p></td><td class="cl-17f6b6e2"><p class="cl-17f6ab34"><span class="cl-17f53c04">-0.987</span></p></td><td class="cl-17f6b6e3"><p class="cl-17f6ab34"><span class="cl-17f53c04">0.3323</span></p></td><td class="cl-17f6b6e4"><p class="cl-17f6ab2a"><span class="cl-17f53c04">   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-17f6b6e5"><p class="cl-17f6ab2a"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b6ec"><p class="cl-17f6ab2a"><span class="cl-17f53c04">factor(A)2</span></p></td><td class="cl-17f6b6ed"><p class="cl-17f6ab34"><span class="cl-17f53c04">1.585</span></p></td><td class="cl-17f6b6ee"><p class="cl-17f6ab34"><span class="cl-17f53c04">0.550</span></p></td><td class="cl-17f6b6f6"><p class="cl-17f6ab34"><span class="cl-17f53c04">27</span></p></td><td class="cl-17f6b6f7"><p class="cl-17f6ab34"><span class="cl-17f53c04">2.880</span></p></td><td class="cl-17f6b6f8"><p class="cl-17f6ab34"><span class="cl-17f53c04">0.0077</span></p></td><td class="cl-17f6b6f9"><p class="cl-17f6ab2a"><span class="cl-17f53c04"> **</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-17f6b6e5"><p class="cl-17f6ab2a"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b6ec"><p class="cl-17f6ab2a"><span class="cl-17f53c04">factor(A)3</span></p></td><td class="cl-17f6b6ed"><p class="cl-17f6ab34"><span class="cl-17f53c04">2.772</span></p></td><td class="cl-17f6b6ee"><p class="cl-17f6ab34"><span class="cl-17f53c04">0.550</span></p></td><td class="cl-17f6b6f6"><p class="cl-17f6ab34"><span class="cl-17f53c04">27</span></p></td><td class="cl-17f6b6f7"><p class="cl-17f6ab34"><span class="cl-17f53c04">5.039</span></p></td><td class="cl-17f6b6f8"><p class="cl-17f6ab34"><span class="cl-17f53c04">0.0000</span></p></td><td class="cl-17f6b6f9"><p class="cl-17f6ab2a"><span class="cl-17f53c04">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-17f6b6ba"><p class="cl-17f6ab35"><span class="cl-17f53c04">Random effects</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-17f6b6d0"><p class="cl-17f6ab2a"><span class="cl-17f53c04">provider</span></p></td><td class="cl-17f6b6d1"><p class="cl-17f6ab2a"><span class="cl-17f53c04">sd__(Intercept)</span></p></td><td class="cl-17f6b6d8"><p class="cl-17f6ab34"><span class="cl-17f53c04">1.144</span></p></td><td class="cl-17f6b6d9"><p class="cl-17f6ab34"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b6da"><p class="cl-17f6ab34"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b6e2"><p class="cl-17f6ab34"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b6e3"><p class="cl-17f6ab34"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b6e4"><p class="cl-17f6ab2a"><span class="cl-17f53c04"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-17f6b700"><p class="cl-17f6ab2a"><span class="cl-17f53c04">Residual</span></p></td><td class="cl-17f6b701"><p class="cl-17f6ab2a"><span class="cl-17f53c04">sd__Observation</span></p></td><td class="cl-17f6b702"><p class="cl-17f6ab34"><span class="cl-17f53c04">2.857</span></p></td><td class="cl-17f6b703"><p class="cl-17f6ab34"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b70a"><p class="cl-17f6ab34"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b70b"><p class="cl-17f6ab34"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b70c"><p class="cl-17f6ab34"><span class="cl-17f53c04"></span></p></td><td class="cl-17f6b714"><p class="cl-17f6ab2a"><span class="cl-17f53c04"></span></p></td></tr></tbody></table></div>
<p>However, we are really interested in comparing CDS with Control and CDS+ with CDS, so we use the <code>glht</code> package to provide the contrasts. To ensure that our overall Type I error rate is 5%, we would use a Bonferroni-corrected p-value threshold of 0.025. In this particular case, we would not infer that there is any benefit to CDS+.</p>
<pre class="r"><code>K1 &lt;- matrix(c(0, 1, 0, 0, -1, 1), 2, byrow = T)
summary(glht(lmerfit, K1))</code></pre>
<pre><code>## 
## 	 Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lmer(formula = y ~ factor(A) + (1 | provider), data = dd)
## 
## Linear Hypotheses:
##        Estimate Std. Error z value Pr(&gt;|z|)   
## 1 == 0   1.5846     0.5501   2.880  0.00766 **
## 2 == 0   1.1876     0.5501   2.159  0.05702 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>In the next step, I’m generating 2500 data sets and fitting a model for each one. The estimated parameters, standard errors, and p-values are saved to an <code>R</code> <em>list</em> so that I can estimate the power to detect an effect for each comparison (based on the assumptions used to generate the data):</p>
<pre class="r"><code>genandfit &lt;- function() {
  
  dc &lt;- genData(30, defs, id = &quot;provider&quot;)
  dd &lt;- genCluster(dc, &quot;provider&quot;, 40, &quot;id&quot;)
  dd &lt;- addColumns(defy, dd)
  
  lmerfit &lt;- lmer(y ~ factor(A) + (1|provider), data = dd)
  K1 &lt;- matrix(c(0, 1, 0, 0, -1, 1), 2, byrow = T)
  data.table(ests = summary(glht(lmerfit, K1))$test$coefficients,
             sd = summary(glht(lmerfit, K1))$test$sigma,
             pvals = summary(glht(lmerfit, K1))$test$pvalues
  )
  
}

reps &lt;- mclapply(1:2500, function(x) genandfit())
reps[1:3]</code></pre>
<pre><code>## [[1]]
##        ests        sd       pvals
## 1: 1.326064 0.4785173 0.010725441
## 2: 1.346511 0.4785173 0.009417302
## 
## [[2]]
##        ests        sd        pvals
## 1: 1.815678 0.4874321 0.0003861366
## 2: 1.859822 0.4874321 0.0002690062
## 
## [[3]]
##         ests        sd      pvals
## 1: 1.2906516 0.4694353 0.01145434
## 2: 0.3629469 0.4694353 0.65599504</code></pre>
<p>The estimated power for each effect estimate is the proportion of iterations with a p-value less than 0.025. Using this three-arm study study design with cluster randomization only, there is 73% power to detect a difference between CDS and Control when the true difference is 1.50, and only 35% power to detect a difference between CDS+ and CDS when the true difference is 0.75:</p>
<pre class="r"><code>pvals &lt;- rbindlist(mclapply(reps, function(x) data.table(t(x[, pvals]))))
pvals[, .(`CDS vs Control` = mean(V1 &lt; 0.025), `CDS+ vs CDS` = mean(V2 &lt; 0.025))]</code></pre>
<pre><code>##    CDS vs Control CDS+ vs CDS
## 1:         0.7292      0.3524</code></pre>
</div>
<div id="two-step-randomization" class="section level3">
<h3>Two-step randomization</h3>
<p>We can use the same process to evaluate the two-step randomization. In this formulation, the clusters are randomized in a 1:2 ratio to control <span class="math inline">\((A = 0)\)</span> or CDS <span class="math inline">\((A = 1)\)</span>. For the the clusters randomized to CDS (<span class="math inline">\(2/3\)</span> of the total), the individual patients are randomized to standard CDS <span class="math inline">\((X=0)\)</span> or CDS+ <span class="math inline">\((X=1)\)</span>. The randomization is stratified by provider with a 1:1 ratio. The randomization scheme this is facilitated by the <code>simstudy</code> <code>defCondition</code> and <code>addCondition</code> functions. Note that for the patients in the control arm, <span class="math inline">\(A=0\)</span> and <span class="math inline">\(X=1\)</span>.</p>
<p>The individual outcome <span class="math inline">\(y\)</span> is generated slightly differently than in the three-arm trial, but the effect sizes are equivalent: 1.50 point difference between standard CDS and control and 0.75 difference between CDS+ and CDS.</p>
<pre class="r"><code>defs &lt;- 
  defData(varname = &quot;b&quot;, formula = 0, variance = 1) |&gt;
  defData(varname = &quot;A&quot;, formula = &quot;1;2&quot;, dist = &quot;trtAssign&quot;)

defc &lt;- 
  defCondition(condition = &quot;A == 1&quot;, formula = &quot;1;1&quot;, 
    variance = &quot;provider&quot;, dist = &quot;trtAssign&quot;) |&gt;
  defCondition(condition = &quot;A == 0&quot;, formula = 0, 
    dist = &quot;nonrandom&quot;)

defy &lt;- 
  defDataAdd(varname = &quot;y&quot;, formula = &quot;0 + 1.50*A + 0.75*X + b&quot;, variance = 8)

dc &lt;- genData(30, defs, id = &quot;provider&quot;)
dd &lt;- genCluster(dc, &quot;provider&quot;, 40, &quot;id&quot;)
dd &lt;- addCondition(defc, dd, &quot;X&quot;)
dd &lt;- addColumns(defy, dd)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>The model for this data set also looks slightly different than the three arm case, as we can model the CDS+ vs CDS directly; there is no need to look at any contrasts.</p>
<pre class="r"><code>lmerfit &lt;- lmer(y ~ A + X + (1|provider), data = dd)
as_flextable(lmerfit) |&gt; delete_part(part = &quot;footer&quot;)</code></pre>
<p><br></p>
<div class="tabwid"><style>.cl-18ded1b6{}.cl-18daf528{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-18dcdf82{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-18dcdf8c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-18dcdf8d{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-18dce8ec{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce8f6{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce8f7{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce8f8{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce900{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce901{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce902{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce90a{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce90b{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce914{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce915{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce916{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce91e{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce91f{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce920{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce921{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce928{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce929{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce92a{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce92b{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce932{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce933{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce93c{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce93d{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce946{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce947{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce948{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce949{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce950{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce951{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce95a{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce95b{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce95c{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce95d{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce964{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce965{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce966{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce96e{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce96f{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce978{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce979{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce97a{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce982{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce983{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce984{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce985{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce98c{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-18dce98d{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-18ded1b6'><thead><tr style="overflow-wrap:break-word;"><th class="cl-18dce8ec"><p class="cl-18dcdf82"><span class="cl-18daf528">group</span></p></th><th class="cl-18dce8f6"><p class="cl-18dcdf82"><span class="cl-18daf528"></span></p></th><th class="cl-18dce8f7"><p class="cl-18dcdf8c"><span class="cl-18daf528">Estimate</span></p></th><th class="cl-18dce8f8"><p class="cl-18dcdf8c"><span class="cl-18daf528">Standard Error</span></p></th><th class="cl-18dce900"><p class="cl-18dcdf8c"><span class="cl-18daf528">df</span></p></th><th class="cl-18dce901"><p class="cl-18dcdf8c"><span class="cl-18daf528">statistic</span></p></th><th class="cl-18dce902"><p class="cl-18dcdf8c"><span class="cl-18daf528">p-value</span></p></th><th class="cl-18dce90a"><p class="cl-18dcdf82"><span class="cl-18daf528"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-18dce90b"><p class="cl-18dcdf8d"><span class="cl-18daf528">Fixed effects</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-18dce928"><p class="cl-18dcdf82"><span class="cl-18daf528"></span></p></td><td class="cl-18dce929"><p class="cl-18dcdf82"><span class="cl-18daf528">(Intercept)</span></p></td><td class="cl-18dce92a"><p class="cl-18dcdf8c"><span class="cl-18daf528">-0.025</span></p></td><td class="cl-18dce92b"><p class="cl-18dcdf8c"><span class="cl-18daf528">0.343</span></p></td><td class="cl-18dce932"><p class="cl-18dcdf8c"><span class="cl-18daf528">28</span></p></td><td class="cl-18dce933"><p class="cl-18dcdf8c"><span class="cl-18daf528">-0.073</span></p></td><td class="cl-18dce93c"><p class="cl-18dcdf8c"><span class="cl-18daf528">0.9419</span></p></td><td class="cl-18dce93d"><p class="cl-18dcdf82"><span class="cl-18daf528">   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-18dce946"><p class="cl-18dcdf82"><span class="cl-18daf528"></span></p></td><td class="cl-18dce947"><p class="cl-18dcdf82"><span class="cl-18daf528">A</span></p></td><td class="cl-18dce948"><p class="cl-18dcdf8c"><span class="cl-18daf528">1.733</span></p></td><td class="cl-18dce949"><p class="cl-18dcdf8c"><span class="cl-18daf528">0.432</span></p></td><td class="cl-18dce950"><p class="cl-18dcdf8c"><span class="cl-18daf528">31</span></p></td><td class="cl-18dce951"><p class="cl-18dcdf8c"><span class="cl-18daf528">4.014</span></p></td><td class="cl-18dce95a"><p class="cl-18dcdf8c"><span class="cl-18daf528">0.0003</span></p></td><td class="cl-18dce95b"><p class="cl-18dcdf82"><span class="cl-18daf528">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-18dce95c"><p class="cl-18dcdf82"><span class="cl-18daf528"></span></p></td><td class="cl-18dce95d"><p class="cl-18dcdf82"><span class="cl-18daf528">X</span></p></td><td class="cl-18dce964"><p class="cl-18dcdf8c"><span class="cl-18daf528">0.970</span></p></td><td class="cl-18dce965"><p class="cl-18dcdf8c"><span class="cl-18daf528">0.205</span></p></td><td class="cl-18dce966"><p class="cl-18dcdf8c"><span class="cl-18daf528">1,169</span></p></td><td class="cl-18dce96e"><p class="cl-18dcdf8c"><span class="cl-18daf528">4.741</span></p></td><td class="cl-18dce96f"><p class="cl-18dcdf8c"><span class="cl-18daf528">0.0000</span></p></td><td class="cl-18dce978"><p class="cl-18dcdf82"><span class="cl-18daf528">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-18dce90b"><p class="cl-18dcdf8d"><span class="cl-18daf528">Random effects</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-18dce928"><p class="cl-18dcdf82"><span class="cl-18daf528">provider</span></p></td><td class="cl-18dce929"><p class="cl-18dcdf82"><span class="cl-18daf528">sd__(Intercept)</span></p></td><td class="cl-18dce92a"><p class="cl-18dcdf8c"><span class="cl-18daf528">0.982</span></p></td><td class="cl-18dce92b"><p class="cl-18dcdf8c"><span class="cl-18daf528"></span></p></td><td class="cl-18dce932"><p class="cl-18dcdf8c"><span class="cl-18daf528"></span></p></td><td class="cl-18dce933"><p class="cl-18dcdf8c"><span class="cl-18daf528"></span></p></td><td class="cl-18dce93c"><p class="cl-18dcdf8c"><span class="cl-18daf528"></span></p></td><td class="cl-18dce93d"><p class="cl-18dcdf82"><span class="cl-18daf528"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-18dce979"><p class="cl-18dcdf82"><span class="cl-18daf528">Residual</span></p></td><td class="cl-18dce97a"><p class="cl-18dcdf82"><span class="cl-18daf528">sd__Observation</span></p></td><td class="cl-18dce982"><p class="cl-18dcdf8c"><span class="cl-18daf528">2.894</span></p></td><td class="cl-18dce983"><p class="cl-18dcdf8c"><span class="cl-18daf528"></span></p></td><td class="cl-18dce984"><p class="cl-18dcdf8c"><span class="cl-18daf528"></span></p></td><td class="cl-18dce985"><p class="cl-18dcdf8c"><span class="cl-18daf528"></span></p></td><td class="cl-18dce98c"><p class="cl-18dcdf8c"><span class="cl-18daf528"></span></p></td><td class="cl-18dce98d"><p class="cl-18dcdf82"><span class="cl-18daf528"></span></p></td></tr></tbody></table></div>
<p>The estimated the power from replicated data sets makes it pretty clear that the two-step randomization design has considerably more power for both effects, each reaching the 80% threshold.</p>
<pre class="r"><code>pvals[, .(`CDS vs Control` = mean(A &lt; .025), `CDS+ vs CDS` = mean(X &lt; 0.025))]</code></pre>
<pre><code>##    CDS vs Control CDS+ vs CDS
## 1:          0.846      0.8324</code></pre>
<p>While it appears that the two-step randomization design is clearly superior to the three-arm cluster randomized design, it is important to again point out the key caveat here that, conditional on the provder, the patient outcomes in the CDS and CDS+ arms patients are independent of each other. For example, if the provider can’t avoid applying CDS+ tools to the CDS only patients, this assumption of independence is violated and the two-step design is not going to be appropriate. A three-arm cluster randomized design with more providers (clusters) will be needed.</p>
</div>
