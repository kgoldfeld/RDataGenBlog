---
title: A three-arm trial using two-step randomization
author: Package Build
date: '2023-12-19'
slug: []
categories: []
tags:
  - R
  - Cluster randomized trials
type: ''
subtitle: ''
image: ''
---

<link href="{{< blogdown/postref >}}index.en_files/tabwid/tabwid.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index.en_files/tabwid/tabwid.js"></script>


<p><a href="https://bartshealth-nhs.libguides.com/CDS" target="_blank">Clinical Decision Support</a> (CDS) tools are systems created to support clinical decision-making. Health care professionals using these tools can get guidance about diagnostic and treatment options when providing care to a patient. I’m currently involved with designing a trial focused on comparing a standard CDS tool with an enhanced version (CDS+). The main goal is to directly compare patient-level outcomes for those who have been exposed to the different versions of the CDS. However, we might also be interested in comparing the basic CDS with a control arm, which would suggest some type of three-arm trial.</p>
<p>A key question is the unit of randomization - should it be at the provider or patient level? If we can assume that CDS and CDS+ can be implemented at the patient level without any contamination, a trial comparing the two CDS versions could take advantage of patient-level randomization. However, once you turn on CDS or CDS+ at the provider level, it may not be possible to have an uncontaminated control arm, suggesting a less efficient cluster randomized trial. One of my colleagues came up with a design that takes advantage of patient-level randomization while acknowledging the need to address potential contamination of the patients in the control arm. This would be accomplished by randomizing providers to either the control or CDS arms, and then randomizing patients within the CDS arm (stratified by provider) to either CDS or CDS+ intervention.</p>
<p>It should be fairly obvious that two-step approach with at least some patient-level randomization would be better (with respect to statistical power) than a more standard three-arm cluster randomized trial that could provide the same effect estimates (though my initial reaction was that it wasn’t so obvious). My goal here is to simulate data (and provide code) using each design and estimate power under each.</p>
<div id="preliminaries" class="section level3">
<h3>Preliminaries</h3>
<p>Before we get started, here are the libraries that will be need for the simulations, model fitting, and outputting the results:</p>
<pre class="r"><code>library(simstudy)
library(ggplot2)
library(lmerTest)
library(data.table)
library(multcomp)
library(parallel)
library(flextable)

RNGkind(&quot;L&#39;Ecuyer-CMRG&quot;)  # to set seed for parallel process</code></pre>
</div>
<div id="three-arm-cluster-randomized-trial" class="section level3">
<h3>Three-arm cluster randomized trial</h3>
<p>We’ll start with the three-arm cluster randomized trial, where providers would be randomized in a 1:1:1 ratio to either <span class="math inline">\(Control\)</span>, <span class="math inline">\(CDS\)</span>, or <span class="math inline">\(CDS+\)</span>. The data definitions for the cluster-level data includes a random effect <span class="math inline">\(b\)</span> and a three-level treatment indicator <span class="math inline">\(A\)</span>. The individual-level outcome is a continuous variable centered around 0 for patients in the control arm (offset by the provider-specific random effect). The effect of CDS (compared to Control) is 1.5, and the incremental effect of CDS+ (compared to CDS) is 0.75.</p>
<pre class="r"><code>defs &lt;- 
  defData(varname = &quot;b&quot;, formula = 0, variance = 1) |&gt;
  defData(varname = &quot;A&quot;, formula = &quot;1;1;1&quot;, dist = &quot;trtAssign&quot;) 

defy &lt;- 
  defDataAdd(varname = &quot;y&quot;, formula = &quot;1.50 * (A==2) + 2.25 * (A==3) + b&quot;, variance = 8)</code></pre>
<p>To generate a single data set, we generate the provider level data, add the patient-level records and generate the patient-level outcomes.</p>
<pre class="r"><code>set.seed(9612)

dc &lt;- genData(30, defs, id = &quot;provider&quot;)
dd &lt;- genCluster(dc, &quot;provider&quot;, 40, &quot;id&quot;)
dd &lt;- addColumns(defy, dd)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>A mixed effects model with a provider-level random effect gives the parameter estimates for the effect of CDS (versus control) and CDS+ (also versus control):</p>
<pre class="r"><code>lmerfit &lt;- lmer(y ~ factor(A) + (1 | provider), data = dd)
as_flextable(lmerfit) |&gt; delete_part(part = &quot;footer&quot;)</code></pre>
<p><br></p>
<div class="tabwid"><style>.cl-c9375b48{}.cl-c9334d00{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c934b73a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c934b744{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c934b745{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c934c1e4{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1e5{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1e6{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1ee{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1ef{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1f0{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1f1{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1f8{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1f9{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1fa{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1fb{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c1fc{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c202{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c203{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c20c{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c20d{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c20e{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c216{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c217{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c218{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c219{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c220{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c221{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c222{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c223{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c22a{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c22b{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c234{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c235{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c236{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c237{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c238{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c239{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c23e{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c23f{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c240{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c241{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c242{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c248{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c934c249{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-c9375b48'><thead><tr style="overflow-wrap:break-word;"><th class="cl-c934c1e4"><p class="cl-c934b73a"><span class="cl-c9334d00">group</span></p></th><th class="cl-c934c1e5"><p class="cl-c934b73a"><span class="cl-c9334d00"></span></p></th><th class="cl-c934c1e6"><p class="cl-c934b744"><span class="cl-c9334d00">Estimate</span></p></th><th class="cl-c934c1ee"><p class="cl-c934b744"><span class="cl-c9334d00">Standard Error</span></p></th><th class="cl-c934c1ef"><p class="cl-c934b744"><span class="cl-c9334d00">df</span></p></th><th class="cl-c934c1f0"><p class="cl-c934b744"><span class="cl-c9334d00">statistic</span></p></th><th class="cl-c934c1f1"><p class="cl-c934b744"><span class="cl-c9334d00">p-value</span></p></th><th class="cl-c934c1f8"><p class="cl-c934b73a"><span class="cl-c9334d00"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-c934c1f9"><p class="cl-c934b745"><span class="cl-c9334d00">Fixed effects</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c934c20e"><p class="cl-c934b73a"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c216"><p class="cl-c934b73a"><span class="cl-c9334d00">(Intercept)</span></p></td><td class="cl-c934c217"><p class="cl-c934b744"><span class="cl-c9334d00">-0.733</span></p></td><td class="cl-c934c218"><p class="cl-c934b744"><span class="cl-c9334d00">0.339</span></p></td><td class="cl-c934c219"><p class="cl-c934b744"><span class="cl-c9334d00">27</span></p></td><td class="cl-c934c220"><p class="cl-c934b744"><span class="cl-c9334d00">-2.164</span></p></td><td class="cl-c934c221"><p class="cl-c934b744"><span class="cl-c9334d00">0.0395</span></p></td><td class="cl-c934c222"><p class="cl-c934b73a"><span class="cl-c9334d00">  *</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c934c223"><p class="cl-c934b73a"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c22a"><p class="cl-c934b73a"><span class="cl-c9334d00">factor(A)2</span></p></td><td class="cl-c934c22b"><p class="cl-c934b744"><span class="cl-c9334d00">1.853</span></p></td><td class="cl-c934c234"><p class="cl-c934b744"><span class="cl-c9334d00">0.479</span></p></td><td class="cl-c934c235"><p class="cl-c934b744"><span class="cl-c9334d00">27</span></p></td><td class="cl-c934c236"><p class="cl-c934b744"><span class="cl-c9334d00">3.865</span></p></td><td class="cl-c934c237"><p class="cl-c934b744"><span class="cl-c9334d00">0.0006</span></p></td><td class="cl-c934c238"><p class="cl-c934b73a"><span class="cl-c9334d00">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c934c223"><p class="cl-c934b73a"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c22a"><p class="cl-c934b73a"><span class="cl-c9334d00">factor(A)3</span></p></td><td class="cl-c934c22b"><p class="cl-c934b744"><span class="cl-c9334d00">2.567</span></p></td><td class="cl-c934c234"><p class="cl-c934b744"><span class="cl-c9334d00">0.479</span></p></td><td class="cl-c934c235"><p class="cl-c934b744"><span class="cl-c9334d00">27</span></p></td><td class="cl-c934c236"><p class="cl-c934b744"><span class="cl-c9334d00">5.353</span></p></td><td class="cl-c934c237"><p class="cl-c934b744"><span class="cl-c9334d00">0.0000</span></p></td><td class="cl-c934c238"><p class="cl-c934b73a"><span class="cl-c9334d00">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-c934c1f9"><p class="cl-c934b745"><span class="cl-c9334d00">Random effects</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c934c20e"><p class="cl-c934b73a"><span class="cl-c9334d00">provider</span></p></td><td class="cl-c934c216"><p class="cl-c934b73a"><span class="cl-c9334d00">sd__(Intercept)</span></p></td><td class="cl-c934c217"><p class="cl-c934b744"><span class="cl-c9334d00">0.975</span></p></td><td class="cl-c934c218"><p class="cl-c934b744"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c219"><p class="cl-c934b744"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c220"><p class="cl-c934b744"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c221"><p class="cl-c934b744"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c222"><p class="cl-c934b73a"><span class="cl-c9334d00"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c934c239"><p class="cl-c934b73a"><span class="cl-c9334d00">Residual</span></p></td><td class="cl-c934c23e"><p class="cl-c934b73a"><span class="cl-c9334d00">sd__Observation</span></p></td><td class="cl-c934c23f"><p class="cl-c934b744"><span class="cl-c9334d00">2.818</span></p></td><td class="cl-c934c240"><p class="cl-c934b744"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c241"><p class="cl-c934b744"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c242"><p class="cl-c934b744"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c248"><p class="cl-c934b744"><span class="cl-c9334d00"></span></p></td><td class="cl-c934c249"><p class="cl-c934b73a"><span class="cl-c9334d00"></span></p></td></tr></tbody></table></div>
<p>However, we are really interested in comparing CDS with Control and CDS+ with CDS (and not CDS+ with control); we can use the <code>glht</code> package to provide the contrasts. To ensure that our overall Type I error rate is 5%, we use a Bonferroni-corrected p-value threshold of 0.025. In this particular case, we would not infer that there is any benefit to CDS+ over CDS, though it does appear that CDS is better than no CDS.</p>
<pre class="r"><code>K1 &lt;- matrix(c(0, 1, 0, 0, -1, 1), 2, byrow = T)
summary(glht(lmerfit, K1))</code></pre>
<pre><code>## 
## 	 Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lmer(formula = y ~ factor(A) + (1 | provider), data = dd)
## 
## Linear Hypotheses:
##        Estimate Std. Error z value Pr(&gt;|z|)    
## 1 == 0   1.8530     0.4794   3.865  0.00022 ***
## 2 == 0   0.7136     0.4794   1.488  0.23509    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>In the next step, I’m generating 2500 data sets and fitting a model for each one. The estimated parameters, standard errors, and p-values are saved to an <code>R</code> <em>list</em> so that I can estimate the power to detect an effect for each comparison (based on the assumptions used to generate the data):</p>
<pre class="r"><code>genandfit &lt;- function() {
  
  dc &lt;- genData(30, defs, id = &quot;provider&quot;)
  dd &lt;- genCluster(dc, &quot;provider&quot;, 40, &quot;id&quot;)
  dd &lt;- addColumns(defy, dd)
  
  lmerfit &lt;- lmer(y ~ factor(A) + (1 | provider), data = dd)
  K1 &lt;- matrix(c(0, 1, 0, 0, -1, 1), 2, byrow = T)
  data.table(ests = summary(glht(lmerfit, K1))$test$coefficients,
             sd = summary(glht(lmerfit, K1))$test$sigma,
             pvals = summary(glht(lmerfit, K1))$test$pvalues
  )
  
}

reps &lt;- mclapply(1:2500, function(x) genandfit())
reps[1:3]</code></pre>
<pre><code>## [[1]]
##         ests        sd       pvals
## 1: 1.6634678 0.5213168 0.002768887
## 2: 0.8372875 0.5213168 0.189092375
## 
## [[2]]
##         ests        sd        pvals
## 1: 0.8206728 0.4380257 0.1097610533
## 2: 1.6465060 0.4380257 0.0003375337
## 
## [[3]]
##        ests        sd        pvals
## 1: 1.340631 0.4691332 0.0082278928
## 2: 1.777505 0.4691332 0.0002994282</code></pre>
<p>The estimated power for each effect estimate is the proportion of iterations with a p-value less than 0.025. Using this standard cluster-randomized three-arm study design, there is 74% power to detect a difference between CDS and Control when the true difference is 1.50, and only 19% power to detect a difference between CDS+ and CDS when the true difference is 0.75:</p>
<pre class="r"><code>pvals &lt;- rbindlist(mclapply(reps, function(x) data.table(t(x[, pvals]))))
pvals[, .(`CDS vs Control` = mean(V1 &lt; 0.025), `CDS+ vs CDS` = mean(V2 &lt; 0.025))]</code></pre>
<pre><code>##    CDS vs Control CDS+ vs CDS
## 1:         0.7356      0.1904</code></pre>
</div>
<div id="two-step-randomization" class="section level3">
<h3>Two-step randomization</h3>
<p>The same process can be applied to evaluate the two-step randomization. In this formulation, the clusters are randomized in a 1:2 ratio to control <span class="math inline">\((A = 0)\)</span> or CDS <span class="math inline">\((A = 1)\)</span>. For the the clusters randomized to CDS (<span class="math inline">\(2/3\)</span> of the total clusters), the individual patients are randomized to standard CDS <span class="math inline">\((X=0)\)</span> or CDS+ <span class="math inline">\((X=1)\)</span>. The randomization is stratified by provider with a 1:1 ratio. The randomization scheme is facilitated by the <code>simstudy</code> <code>defCondition</code> and <code>addCondition</code> functions. For the patients in the control arm, <span class="math inline">\(A=0\)</span> and <span class="math inline">\(X=0\)</span>.</p>
<p>The individual outcome <span class="math inline">\(y\)</span> is generated slightly differently than in the three-arm trial, but the effect sizes are equivalent: 1.50 point difference between standard CDS and control and 0.75 difference between CDS+ and CDS.</p>
<pre class="r"><code>defs &lt;- 
  defData(varname = &quot;b&quot;, formula = 0, variance = 1) |&gt;
  defData(varname = &quot;A&quot;, formula = &quot;1;2&quot;, dist = &quot;trtAssign&quot;)

defc &lt;- 
  defCondition(condition = &quot;A == 1&quot;, formula = &quot;1;1&quot;, 
    variance = &quot;provider&quot;, dist = &quot;trtAssign&quot;) |&gt;
  defCondition(condition = &quot;A == 0&quot;, formula = 0, 
    dist = &quot;nonrandom&quot;)

defy &lt;- 
  defDataAdd(varname = &quot;y&quot;, formula = &quot;1.50 * A + 0.75 * X + b&quot;, variance = 8)

dc &lt;- genData(30, defs, id = &quot;provider&quot;)
dd &lt;- genCluster(dc, &quot;provider&quot;, 40, &quot;id&quot;)
dd &lt;- addCondition(defc, dd, &quot;X&quot;)
dd &lt;- addColumns(defy, dd)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>The model for this data set also looks slightly different than the three arm case, as we can model the CDS+ vs CDS directly; as a result, there is no need to consider the contrasts. In this example, we would conclude that CDS+ is an improvement over CDS and CDS is better than no CDS.</p>
<pre class="r"><code>lmerfit &lt;- lmer(y ~ A + X + (1|provider), data = dd)
as_flextable(lmerfit) |&gt; delete_part(part = &quot;footer&quot;)</code></pre>
<p><br></p>
<div class="tabwid"><style>.cl-e1571538{}.cl-e1534ee4{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e154a03c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e154a03d{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e154a046{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e154a910{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a911{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a91a{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a91b{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a91c{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a924{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a925{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a92e{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a92f{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a930{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a938{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a939{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a93a{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a93b{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a942{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a943{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a944{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a945{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a94c{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a960{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a96a{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a96b{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a96c{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a974{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a975{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a97e{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a97f{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a980{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a988{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a989{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a98a{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a992{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a993{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a994{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a99c{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a99d{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9a6{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9a7{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9a8{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9a9{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9b0{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9b1{width:1.44in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9b2{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9ba{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9bb{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9bc{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9c4{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e154a9c5{width:0.4in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-e1571538'><thead><tr style="overflow-wrap:break-word;"><th class="cl-e154a910"><p class="cl-e154a03c"><span class="cl-e1534ee4">group</span></p></th><th class="cl-e154a911"><p class="cl-e154a03c"><span class="cl-e1534ee4"></span></p></th><th class="cl-e154a91a"><p class="cl-e154a03d"><span class="cl-e1534ee4">Estimate</span></p></th><th class="cl-e154a91b"><p class="cl-e154a03d"><span class="cl-e1534ee4">Standard Error</span></p></th><th class="cl-e154a91c"><p class="cl-e154a03d"><span class="cl-e1534ee4">df</span></p></th><th class="cl-e154a924"><p class="cl-e154a03d"><span class="cl-e1534ee4">statistic</span></p></th><th class="cl-e154a925"><p class="cl-e154a03d"><span class="cl-e1534ee4">p-value</span></p></th><th class="cl-e154a92e"><p class="cl-e154a03c"><span class="cl-e1534ee4"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-e154a92f"><p class="cl-e154a046"><span class="cl-e1534ee4">Fixed effects</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e154a944"><p class="cl-e154a03c"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a945"><p class="cl-e154a03c"><span class="cl-e1534ee4">(Intercept)</span></p></td><td class="cl-e154a94c"><p class="cl-e154a03d"><span class="cl-e1534ee4">-0.123</span></p></td><td class="cl-e154a960"><p class="cl-e154a03d"><span class="cl-e1534ee4">0.362</span></p></td><td class="cl-e154a96a"><p class="cl-e154a03d"><span class="cl-e1534ee4">28</span></p></td><td class="cl-e154a96b"><p class="cl-e154a03d"><span class="cl-e1534ee4">-0.341</span></p></td><td class="cl-e154a96c"><p class="cl-e154a03d"><span class="cl-e1534ee4">0.7358</span></p></td><td class="cl-e154a974"><p class="cl-e154a03c"><span class="cl-e1534ee4">   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e154a975"><p class="cl-e154a03c"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a97e"><p class="cl-e154a03c"><span class="cl-e1534ee4">A</span></p></td><td class="cl-e154a97f"><p class="cl-e154a03d"><span class="cl-e1534ee4">1.641</span></p></td><td class="cl-e154a980"><p class="cl-e154a03d"><span class="cl-e1534ee4">0.455</span></p></td><td class="cl-e154a988"><p class="cl-e154a03d"><span class="cl-e1534ee4">31</span></p></td><td class="cl-e154a989"><p class="cl-e154a03d"><span class="cl-e1534ee4">3.608</span></p></td><td class="cl-e154a98a"><p class="cl-e154a03d"><span class="cl-e1534ee4">0.0011</span></p></td><td class="cl-e154a992"><p class="cl-e154a03c"><span class="cl-e1534ee4"> **</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e154a993"><p class="cl-e154a03c"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a994"><p class="cl-e154a03c"><span class="cl-e1534ee4">X</span></p></td><td class="cl-e154a99c"><p class="cl-e154a03d"><span class="cl-e1534ee4">1.078</span></p></td><td class="cl-e154a99d"><p class="cl-e154a03d"><span class="cl-e1534ee4">0.200</span></p></td><td class="cl-e154a9a6"><p class="cl-e154a03d"><span class="cl-e1534ee4">1,169</span></p></td><td class="cl-e154a9a7"><p class="cl-e154a03d"><span class="cl-e1534ee4">5.391</span></p></td><td class="cl-e154a9a8"><p class="cl-e154a03d"><span class="cl-e1534ee4">0.0000</span></p></td><td class="cl-e154a9a9"><p class="cl-e154a03c"><span class="cl-e1534ee4">***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-e154a92f"><p class="cl-e154a046"><span class="cl-e1534ee4">Random effects</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e154a944"><p class="cl-e154a03c"><span class="cl-e1534ee4">provider</span></p></td><td class="cl-e154a945"><p class="cl-e154a03c"><span class="cl-e1534ee4">sd__(Intercept)</span></p></td><td class="cl-e154a94c"><p class="cl-e154a03d"><span class="cl-e1534ee4">1.055</span></p></td><td class="cl-e154a960"><p class="cl-e154a03d"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a96a"><p class="cl-e154a03d"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a96b"><p class="cl-e154a03d"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a96c"><p class="cl-e154a03d"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a974"><p class="cl-e154a03c"><span class="cl-e1534ee4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e154a9b0"><p class="cl-e154a03c"><span class="cl-e1534ee4">Residual</span></p></td><td class="cl-e154a9b1"><p class="cl-e154a03c"><span class="cl-e1534ee4">sd__Observation</span></p></td><td class="cl-e154a9b2"><p class="cl-e154a03d"><span class="cl-e1534ee4">2.828</span></p></td><td class="cl-e154a9ba"><p class="cl-e154a03d"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a9bb"><p class="cl-e154a03d"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a9bc"><p class="cl-e154a03d"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a9c4"><p class="cl-e154a03d"><span class="cl-e1534ee4"></span></p></td><td class="cl-e154a9c5"><p class="cl-e154a03c"><span class="cl-e1534ee4"></span></p></td></tr></tbody></table></div>
<p>The estimated the power from replicated data sets makes it pretty clear that the two-step randomization design has considerably more power for both effects, each reaching the 80% threshold.</p>
<pre class="r"><code>pvals[, .(`CDS vs Control` = mean(A &lt; .025), `CDS+ vs CDS` = mean(X &lt; 0.025))]</code></pre>
<pre><code>##    CDS vs Control CDS+ vs CDS
## 1:         0.8392      0.8544</code></pre>
<p>While it appears that the two-step randomization design is clearly superior to the three-arm cluster randomized design, it is important to again point out the key caveat here that, conditional on the provider, the patient outcomes in the CDS and CDS+ arms patients need to be independent of each other. For example, if the provider can’t avoid applying CDS+ tools to the CDS only patients, this assumption of independence is violated and the two-step design is not going to be appropriate. Instead, a three-arm cluster randomized design with more providers (clusters) will be needed.</p>
</div>
